{% extends 'base.html' %}
{% block title %}Admin Dashboard{% endblock %}

{% block content %}
<div class="dashboard-container">

    <h2 class="dashboard-title">Admin Dashboard</h2>

    <!-- ================= TOP BAR ================= -->
    <div class="top-bar">

        <!-- Search -->
        <form method="get" class="search-form">
            <input 
                type="text" 
                name="q" 
                placeholder="Search by name, email, department"
                value="{{ query|default:'' }}"
            >
            <button type="submit" class="btn search">
                ğŸ” Search
            </button>
        </form>

        <!-- Action Buttons -->
        <div class="action-buttons">

            <a href="{% url 'students:add_student' %}" class="btn add">
                â• Add Student
            </a>

            <a href="{% url 'students:charts' %}" class="btn charts">
                ğŸ“Š Charts
            </a>

            <a href="{% url 'students:export_pdf' %}" class="btn pdf">
                ğŸ“„ Export PDF
            </a>

            <a href="{% url 'accounts:logout' %}" class="btn logout">
                ğŸšª Logout
            </a>

        </div>
    </div>


    <!-- ================= STUDENT TABLE ================= -->
    <div class="table-wrapper">
        <table class="student-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Department</th>
                    <th>Year</th>
                    <th class="action-header">Action</th>
                </tr>
            </thead>

            <tbody>
            {% for s in students %}
                <tr>
                    <td>{{ s.name }}</td>
                    <td>{{ s.email }}</td>
                    <td>{{ s.department }}</td>
                    <td>{{ s.year }}</td>

                    <td class="action-col">

                        <a href="{% url 'students:update_student' s.id %}" 
                           class="action-btn edit-btn">
                            âœ Edit
                        </a>

                        <a href="{% url 'students:delete_student' s.id %}" 
                           class="action-btn delete-btn"
                           onclick="return confirm('Are you sure you want to delete this student?')">
                            ğŸ—‘ Delete
                        </a>

                        <a href="{% url 'students:attendance' s.id %}" 
                           class="action-btn attendance-btn">
                            ğŸ“Œ Attendance
                        </a>

                    </td>
                </tr>

            {% empty %}
                <tr>
                    <td colspan="5" class="empty">
                        No students found
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>


    <!-- ================= PAGINATION ================= -->
    <div class="pagination">
        {% if students.has_previous %}
            <a href="?page=1{% if query %}&q={{ query }}{% endif %}" class="page-btn">First</a>
            <a href="?page={{ students.previous_page_number }}{% if query %}&q={{ query }}{% endif %}" class="page-btn">Previous</a>
        {% endif %}

        <span class="current-page">
            Page {{ students.number }} of {{ students.paginator.num_pages }}
        </span>

        {% if students.has_next %}
            <a href="?page={{ students.next_page_number }}{% if query %}&q={{ query }}{% endif %}" class="page-btn">Next</a>
            <a href="?page={{ students.paginator.num_pages }}{% if query %}&q={{ query }}{% endif %}" class="page-btn">Last</a>
        {% endif %}
    </div>

</div>
{% endblock %}
